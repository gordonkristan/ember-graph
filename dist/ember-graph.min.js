(function(){window.EmberGraph=window.EG=Em.Namespace.create({VERSION:"0.1.0"}),Ember.libraries&&Ember.libraries.register("Ember Graph",EG.VERSION)})(),function(){Em&&Em.onLoad("Ember.Application",function(a){a.initializer({name:"injectStore",before:"store",initialize:function(a,b){b.inject("controller","store","store:main"),b.inject("route","store","store:main"),b.inject("adapter","store","store:main"),b.inject("serializer","store","store:main")}}),a.initializer({name:"store",initialize:function(a,b){b.register("store:main",b.Store||EG.Store,{singleton:!0}),b.register("adapter:rest",EG.RESTAdapter,{singleton:!0}),b.register("serializer:json",EG.JSONSerializer,{singleton:!0}),b.register("serializer:ember_graph_database",EG.EmberGraphDatabaseSerializer,{singleton:!0}),b.register("type:string",EG.StringType,{singleton:!0}),b.register("type:number",EG.NumberType,{singleton:!0}),b.register("type:boolean",EG.BooleanType,{singleton:!0}),b.register("type:date",EG.DateType,{singleton:!0}),b.register("type:object",EG.ObjectType,{singleton:!0}),b.register("type:array",EG.ArrayType,{singleton:!0});var c=a.lookup("store:main");b.set("store",c)}})})}(),function(){var a=Em.ArrayPolyfills.reduce;EG.abstractMethod=function(a){return function(){throw new Error("You failed to implement the abstract `"+a+"` method.")}},EG.abstractProperty=function(a){return Em.computed(function(){throw new Error("You failed to override the abstract `"+a+"` property.")}).property()},EG.generateUUID=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"==a?b:3&b|8;return c.toString(16)})},EG.arrayContentsEqual=function(a,b){return a.length===b.length&&new Em.Set(a).isEqual(b)},EG.groupRecords=function(b){var c=a.call(b,function(a,b){return a[b.type]?a[b.type].push(b):a[b.type]=[b],a},{});return a.call(Em.keys(c),function(a,b){return c[b].length>0&&a.push(c[b]),a},[])}}(),function(){Em.Set.reopen({withoutAll:function(a){var b=this.copy();return b.removeObjects(a),b}})}(),function(){EG.ArrayPolyfills={some:function(a,b,c){for(var d=0;d<a.length;++d)if(b.call(c,a[d],d,a))return!0}},Em.SHIM_ES5&&(Array.prototype.some=Array.prototype.some||function(a,b){return EG.ArrayPolyfills.some(this,a,b)})}(),function(){EG.String={startsWith:function(a,b){return 0===a.indexOf(b)},endsWith:function(a,b){return a.indexOf(b,a.length-b.length)>=0},capitalize:function(a){return a[0].toLocaleUpperCase()+a.substring(1)},decapitalize:function(a){return a[0].toLocaleLowerCase()+a.substring(1)}},(Em.EXTEND_PROTOTYPES===!0||Em.EXTEND_PROTOTYPES.String)&&(String.prototype.startsWith=String.prototype.startsWith||function(a){return EG.String.startsWith(this,a)},String.prototype.endsWith=String.prototype.endsWith||function(a){return EG.String.endsWith(this,a)},String.prototype.capitalize=String.prototype.capitalize||function(){return EG.String.capitalize(this)},String.prototype.decapitalize=String.prototype.decapitalize||function(){return EG.String.decapitalize(this)})}(),function(){var a=["equipment","information","rice","money","species","series","fish","sheep","moose","deer","news"],b=[[/(m)an$/gi,"$1en"],[/(pe)rson$/gi,"$1ople"],[/(child)$/gi,"$1ren"],[/^(ox)$/gi,"$1en"],[/(ax|test)is$/gi,"$1es"],[/(octop|vir)us$/gi,"$1i"],[/(alias|status)$/gi,"$1es"],[/(bu)s$/gi,"$1ses"],[/(buffal|tomat|potat)o$/gi,"$1oes"],[/([ti])um$/gi,"$1a"],[/sis$/gi,"ses"],[/(?:([^f])fe|([lr])f)$/gi,"$1$2ves"],[/(hive)$/gi,"$1s"],[/([^aeiouy]|qu)y$/gi,"$1ies"],[/(x|ch|ss|sh)$/gi,"$1es"],[/(matr|vert|ind)ix|ex$/gi,"$1ices"],[/([m|l])ouse$/gi,"$1ice"],[/(quiz)$/gi,"$1zes"],[/s$/gi,"s"],[/$/gi,"s"]],c=[[/(m)en$/gi,"$1an"],[/(pe)ople$/gi,"$1rson"],[/(child)ren$/gi,"$1"],[/([ti])a$/gi,"$1um"],[/((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)ses$/gi,"$1$2sis"],[/(hive)s$/gi,"$1"],[/(tive)s$/gi,"$1"],[/(curve)s$/gi,"$1"],[/([lr])ves$/gi,"$1f"],[/([^fo])ves$/gi,"$1fe"],[/([^aeiouy]|qu)ies$/gi,"$1y"],[/(s)eries$/gi,"$1eries"],[/(m)ovies$/gi,"$1ovie"],[/(x|ch|ss|sh)es$/gi,"$1"],[/([m|l])ice$/gi,"$1ouse"],[/(bus)es$/gi,"$1"],[/(o)es$/gi,"$1"],[/(shoe)s$/gi,"$1"],[/(cris|ax|test)es$/gi,"$1is"],[/(octop|vir)i$/gi,"$1us"],[/(alias|status)es$/gi,"$1"],[/^(ox)en/gi,"$1"],[/(vert|ind)ices$/gi,"$1ex"],[/(matr)ices$/gi,"$1ix"],[/(quiz)zes$/gi,"$1"],[/s$/gi,""]],d=function(b,c){if(a.indexOf(b)>=0)return b;for(var d=0;d<c.length;d+=1)if(b.match(c[d][0]))return b.replace(c[d][0],c[d][1]);return b};EG.String.pluralize=function(a){return d(a,b)},EG.String.singularize=function(a){return d(a,c)},(Em.EXTEND_PROTOTYPES===!0||Em.EXTEND_PROTOTYPES.String)&&(String.prototype.pluralize=String.prototype.pluralize||function(){return EG.String.pluralize(this)},String.prototype.singularize=String.prototype.singularize||function(){return EG.String.singularize(this)})}(),function(){EG.Serializer=Em.Object.extend({store:null,serialize:EG.abstractMethod("serialize"),deserialize:EG.abstractMethod("deserialize")})}(),function(){EG.EmberGraphDatabaseSerializer=EG.Serializer.extend({serialize:function(a){var b={};a.get("isNew")||(b.id=a.get("id"));var c=this.get("store");return a.constructor.eachAttribute(function(d,e){var f=c.attributeTypeFor(e.type);b[d]=f.serialize(a.get(d))}),b},deserialize:function(a,b){var c={id:a.id+""},d=this.get("store"),e=d.modelForType(b.recordType);return e.eachAttribute(function(b,f){var g=d.attributeTypeFor(f.type);if(void 0===a[b]){if(f.isRequired){var h={id:a.id,typeKey:e.typeKey,name:b};throw new Error("Attribute was missing: "+JSON.stringify(h))}c[b]=void 0===f.defaultValue?g.get("defaultValue"):f.defaultValue}else c[b]=g.deserialize(a[b])}),c}})}(),function(){var a=Ember.ArrayPolyfills.map,b=Ember.ArrayPolyfills.filter,c=Ember.ArrayPolyfills.forEach,d=function(a){return"[object Array]"===Object.prototype.toString.call(a)},e=function(a){return null===a?null:a+""};EG.JSONSerializer=EG.Serializer.extend({serialize:function(a,b){switch(b.requestType){case"updateRecord":return this.serializeDelta(a);case"createRecord":var c={};return c[EG.String.pluralize(a.typeKey)]=[this.serializeRecord(a)],c;default:throw new Error("Invalid request type for JSON serializer.")}},serializeRecord:function(a){var b={links:{}};return a.constructor.eachAttribute(function(c){var d=this.serializeAttribute(a,c);d&&(b[d.name]=d.value)},this),a.constructor.eachRelationship(function(c){var d=this.serializeRelationship(a,c);d&&(b.links[d.name]=d.value)},this),b},serializeAttribute:function(a,b){var c=a.constructor.metaForAttribute(b),d=this.get("store").attributeTypeFor(c.type);return{name:b,value:d.serialize(a.get(b))}},serializeRelationship:function(a,c){var d=a.constructor.metaForRelationship(c),e=a.get("_"+c);return d.kind===EG.Model.HAS_ONE_KEY?(null===e||EG.Model.isTemporaryId(e))&&(e=null):d.kind===EG.Model.HAS_MANY_KEY&&(e=b.call(e,function(a){return!EG.Model.isTemporaryId(a)})),{name:c,value:e}},serializeDelta:function(a){var b=[];return b=b.concat(this.serializeAttributeDelta(a)),b=b.concat(this.serializeRelationshipDelta(a))},serializeAttributeDelta:function(b){var c=b.changedAttributes(),d=this.get("store");return a.call(Em.keys(c),function(a){var e=b.constructor.metaForAttribute(a),f=d.attributeTypeFor(e.type),g=f.serialize(c[a][1]);return{op:"replace",path:"/"+a,value:g}})},serializeRelationshipDelta:function(a){var b=[],d=a.changedRelationships();return c.call(Em.keys(d),function(c){var e=d[c],f=a.constructor.metaForRelationship(c);if(f.kind===EG.Model.HAS_ONE_KEY)b.push({op:"replace",path:"/links/"+c,value:e[1]});else if(f.kind===EG.Model.HAS_MANY_KEY){var g=new Em.Set(e[1]).withoutAll(e[0]),h=new Em.Set(e[0]).withoutAll(e[1]);g.forEach(function(a){b.push({op:"add",path:"/links/"+c+"/-",value:a})}),h.forEach(function(a){b.push({op:"remove",path:"/links/"+c+"/"+a})})}}),b},deserialize:function(b,d){b=b||{},d=d||{};var e=this.get("store"),f=this.transformPayload(b,d);return c.call(Em.keys(f),function(b){if("meta"!==b){var c=e.modelForType(b);f[b]=a.call(f[b],function(a){return this.deserializeRecord(c,a)},this)}},this),f},transformPayload:function(b,d){if(!b||0===Em.keys(b).length)return{};var f={meta:{serverMeta:b.meta||{}}};return delete b.meta,"findQuery"===d.requestType?f.meta.queryIds=a.call(b[EG.String.pluralize(d.recordType)],function(a){return e(a.id)}):"createRecord"===d.requestType&&(f.meta.newId=e(b[EG.String.pluralize(d.recordType)][0].id)),c.call(Em.keys(b),function(a){"linked"!==a&&"meta"!==a&&(f[EG.String.singularize(a)]=b[a],delete b[a])}),c.call(Em.keys(b.linked||{}),function(a){f[EG.String.singularize(a)]=b.linked[a]}),f},deserializeRecord:function(a,b){var c={id:e(b.id)};switch(Em.typeOf(b.id)){case"string":case"number":c.id=e(b.id);break;case"undefined":throw new Error("Your JSON is missing an ID: "+JSON.stringify(b));default:throw new Error("Your JSON has an invalid ID: "+JSON.stringify(b))}return a.eachAttribute(function(d){var e=this.deserializeAttribute(a,b,d);e&&(c[e.name]=e.value)},this),b.links=b.links||{},a.eachRelationship(function(d){var e=this.deserializeRelationship(a,b,d);e&&(c[e.name]=e.value)},this),c},deserializeAttribute:function(a,b,c){var d,e=a.metaForAttribute(c),f=this.get("store").attributeTypeFor(e.type),g=b[c];if(void 0===g){if(e.isRequired)throw d={id:b.id,typeKey:a.typeKey,name:c},new Error("Attribute was missing: "+JSON.stringify(d));return{name:c,value:void 0===e.defaultValue?f.get("defaultValue"):e.defaultValue}}return{name:c,value:g}},deserializeRelationship:function(b,c,f){var g,h=b.metaForRelationship(f),i=c.links[f];if(void 0===i){if(h.isRequired)throw g={id:c.id,typeKey:b.typeKey,name:f},new Error("Relationship was missing: "+JSON.stringify(g));return{name:f,value:i}}if(h.kind!==EG.Model.HAS_ONE_KEY){if(h.kind===EG.Model.HAS_MANY_KEY){if(!d(i))throw g={id:c.id,typeKey:b.typeKey,name:f,value:i},new Error("Invalid hasMany relationship value: "+JSON.stringify(g));return{name:f,value:a.call(i,function(a){switch(Em.typeOf(a)){case"string":case"number":return e(a);default:case"null":throw g={id:c.id,typeKey:b.typeKey,name:f,value:i},new Error("Invalid hasMany relationship value: "+JSON.stringify(g))}})}}return null}switch(Em.typeOf(i)){case"null":case"string":case"number":return{name:f,value:e(i)};default:throw g={id:c.id,typeKey:b.typeKey,name:f,value:i},new Error("Invalid hasOne relationship value: "+JSON.stringify(g))}}})}(),function(){EG.Adapter=Em.Object.extend({store:null,defaultSerializer:"json",serializer:Em.computed(function(){var a=this.get("container"),b=a.lookup("serializer:application")||a.lookup("serializer:"+this.get("defaultSerializer"));return b}).property().readOnly(),createRecord:EG.abstractMethod("createRecord"),findRecord:EG.abstractMethod("findRecord"),findMany:EG.abstractMethod("findMany"),findAll:EG.abstractMethod("findAll"),findQuery:EG.abstractMethod("findQuery"),updateRecord:EG.abstractMethod("updateRecord"),deleteRecord:EG.abstractMethod("deleteRecord"),serialize:function(a,b){return this.get("serializer").serialize(a,b)},deserialize:function(a,b){return this.get("serializer").deserialize(a,b)}})}(),function(){var a=Em.RSVP.Promise;EG.EmberGraphDatabaseAdapter=EG.Adapter.extend({database:EG.abstractProperty("database"),serializer:Em.computed(function(){return this.get("container").lookup("serializer:ember_graph_database")}).property().readOnly(),createRecord:function(b){try{var c=this.serverCreateRecord(b),d={meta:{newId:c.id}};return d[b.typeKey]=[c],a.resolve(d)}catch(e){return a.reject()}},findRecord:function(b,c){try{var d=this.retrieveRecord(b,c),e=this.deserialize(d,{recordType:b}),f={};return f[b]=[e],a.resolve(f)}catch(g){return a.reject()}},findMany:function(b,c){try{var d=map.call(c,function(a){return this.retrieveRecord(b,a)},this),e=map.call(d,function(a){return this.deserialize(a,{recordType:b})},this),f={};return f[b]=e,a.resolve(f)}catch(g){return a.reject()}},findAll:function(b){try{var c=this.retrieveRecords(b),d=map.call(c,function(a){return this.deserialize(a,{recordType:b})},this),e={};return e[b]=d,a.resolve(e)}catch(f){return a.reject()}},findQuery:function(b,c){try{var d=this.retrieveRecords(b,c),e=map.call(d,function(a){return this.deserialize(a,{recordType:b})},this),f={};return f[b]=e,a.resolve(f)}catch(g){return a.reject()}},updateRecord:function(b){try{var c=this.serverUpdateRecord(b),d={};return d[b.typeKey]=[c],a.resolve(d)}catch(e){return a.reject()}},deleteRecord:function(b){try{return this.serverDeleteRecord(b),a.resolve()}catch(c){return a.reject()}}})}(),function(){var a=Em.RSVP.Promise,b=Em.ArrayPolyfills.forEach;EG.RESTAdapter=EG.Adapter.extend({createRecord:function(a){var b=this,c=this.buildUrl(a.typeKey),d=this.serialize(a,{requestType:"createRecord"});return this.ajax(c,"POST",d).then(function(c){return b.deserialize(c,{requestType:"createRecord",recordType:a.typeKey})})},findRecord:function(a,b){var c=this,d=this.buildUrl(a,b);return this.ajax(d,"GET").then(function(d){return c.deserialize(d,{requestType:"findRecord",recordType:a,id:b})})},findMany:function(a,b){var c=this,d=this.buildUrl(a,b.join(","));return this.ajax(d,"GET").then(function(d){return c.deserialize(d,{requestType:"findMany",recordType:a,ids:b})})},findAll:function(a){var b=this,c=this.buildUrl(a);return this.ajax(c,"GET").then(function(c){return b.deserialize(c,{requestType:"findAll",recordType:a})})},findQuery:function(a,c){var d=this,e={};b.call(Em.keys(c),function(a){e[a]=""+c[a]});var f=this.buildUrl(a,null,e);return this.ajax(f,"GET").then(function(b){return d.deserialize(b,{requestType:"findQuery",recordType:a,query:c})})},updateRecord:function(b){var c=this,d=this.buildUrl(b.typeKey,b.get("id")),e=this.serialize(b,{requestType:"updateRecord"});return e.length<=0?a.resolve():this.ajax(d,"PATCH",e).then(function(a){return c.deserialize(a,{requestType:"updateRecord",recordType:b.typeKey})})},deleteRecord:function(a){var b=this,c=this.buildUrl(a.typeKey,a.get("id"));return this.ajax(c,"DELETE").then(function(c){var d={requestType:"deleteRecord",recordType:a.typeKey};return b.deserialize(c,d)})},buildUrl:function(a,c,d){var e=this.get("prefix")+"/"+EG.String.pluralize(a);return c&&(e+="/"+c),d&&b.call(Em.keys(d),function(a,b){e+=(0===b?"?":"&")+a+"="+encodeURIComponent(d[a])}),e},prefix:Em.computed(function(){return""}).property(),ajax:function(b,c,d){var e=this.headers(b,c,d);return new a(function(a,f){$.ajax({cache:!1,contentType:"application/json",data:void 0===d?void 0:"string"===Em.typeOf(d)?d:JSON.stringify(d),headers:e,processData:!1,type:c,url:b,error:function(a,b,c){Em.run(null,f,c)},success:function(b){Em.run(null,a,b)}})})},headers:function(){return{}}})}(),function(){EG.Store=Em.Object.extend({cacheTimeout:1/0,reloadDirty:!0,sideWithClientOnConflict:!0,overwriteClientAttributes:!1,_records:{},adapterCache:{},init:function(){this._super(),this.set("_records",{}),this.set("_types",{}),this.set("_relationships",{}),this.set("_queuedRelationships",{}),this.set("adapterCache",{})},_getRecord:function(a,b){var c=this.get("_records");return c[a]=c[a]||{},c[a][b]},_setRecord:function(a,b){var c=this.get("_records");c[a]=c[a]||{},c[a][b.get("id")]={record:b,timestamp:(new Date).getTime()}},_deleteRecord:function(a,b){var c=this.get("_records");c[a]=c[a]||{},delete c[a][b]},modelForType:function(a){this._modelCache=this._modelCache||{};var b=this.get("container").lookupFactory("model:"+a);return this._modelCache[a]||(this._modelCache[a]=b,b.reopen({typeKey:a}),b.reopenClass({typeKey:a})),b},createRecord:function(a,b){b=b||{};var c=this.modelForType(a)._create();return c.set("store",this),c.set("id",EG.Model.temporaryIdPrefix+EG.generateUUID()),this._setRecord(a,c),c.loadData(b),c},_loadRecord:function(a,b){var c=this.modelForType(a)._create();return c.set("store",this),c.set("id",b.id),this._setRecord(a,c),this.connectQueuedRelationships(c),c.loadData(b),c},cachedRecordsFor:function(a){var b=this.get("_records."+a)||{},c=(new Date).getTime()-this.get("cacheTimeout");return Em.keys(b).map(function(a){var d=b[a];return d.timestamp>=c?d.record:void 0})},find:function(a,b){if(arguments.length>1&&!b)throw new Ember.Error("A bad `find` call was made to the store.");switch(Em.typeOf(b)){case"string":return this._findSingle(a,b);case"array":return this._findMany(a,b);case"object":return this._findQuery(a,b);case"undefined":return this._findAll(a);default:throw new Ember.Error("A bad `find` call was made to the store.")}},getRecord:function(a,b){var c=this._getRecord(a,b),d=(new Date).getTime()-this.get("cacheTimeout");return c&&c.record?c.timestamp>=d?c.record:null:null},_findSingle:function(a,b){var c,d=this.getRecord(a,b);return c=d?Em.RSVP.Promise.resolve(d):this.adapterFor(a).findRecord(a,b).then(function(c){return this.extractPayload(c),this.getRecord(a,b)}.bind(this)),EG.ModelPromiseObject.create({id:b,promise:c})},_findMany:function(a,b){b=b||[];var c=new Em.Set(b);b.forEach(function(b){null!==this.getRecord(a,b)&&c.removeObject(b)},this);var d;return d=0===c.length?Em.RSVP.Promise.resolve(b.map(function(b){return this.getRecord(a,b)},this)):this.adapterFor(a).findMany(a,c.toArray()).then(function(c){return this.extractPayload(c),b.map(function(b){return this.getRecord(a,b)},this).toArray()}.bind(this)),EG.PromiseArray.create({promise:d})},_findAll:function(a){var b=this.adapterFor(a).findAll(a).then(function(b){return this.extractPayload(b),this.cachedRecordsFor(a)}.bind(this));return EG.PromiseArray.create({promise:b})},_findQuery:function(a,b){var c=this.adapterFor(a).findQuery(a,b).then(function(b){var c=b.meta.ids;return this.extractPayload(b),c.map(function(b){return this.getRecord(a,b)},this)}.bind(this));return EG.PromiseArray.create({promise:c})},hasRecord:function(a,b){return null!==this.getRecord(a,b)},saveRecord:function(a){var b=a.typeKey,c=a.get("isNew"),d=a.get("id");return c?this.adapterFor(a.typeKey).createRecord(a).then(function(c){return a.set("id",c.meta.newId),this._deleteRecord(b,d),this._setRecord(b,a),this.extractPayload(c),a}.bind(this)):this.adapterFor(a.typeKey).updateRecord(a).then(function(b){return this.extractPayload(b),a}.bind(this))},deleteRecord:function(a){{var b=a.typeKey,c=a.get("id");this.get("_records."+b)||{}}return this.adapterFor(a.typeKey).deleteRecord(a).then(function(a){this.deleteRelationshipsForRecord(b,c),this.extractPayload(a),this._deleteRecord(b,c)}.bind(this))},reloadRecord:function(a){return this.adapterFor(a.typeKey).findRecord(a.typeKey,a.get("id")).then(function(b){return this.extractPayload(b),a}.bind(this))},extractPayload:function(a){Em.changeProperties(function(){var b=this.get("reloadDirty");Em.keys(a).forEach(function(c){if("meta"!==c){{this.modelForType(c)}a[c].forEach(function(a){var d=this.getRecord(c,a.id);d?(!d.get("isDirty")||b)&&d.loadData(a):this._loadRecord(c,a)},this)}},this)},this)},attributeTypeFor:function(a){var b=this.get("container").lookup("type:"+a);return b},adapterFor:function(a){var b=this.get("adapterCache");if(!b[a]){var c=this.get("container");b[a]=c.lookup("adapter:"+a)||c.lookup("adapter:application")||c.lookup("adapter:rest")}return b[a]}})}(),function(){var a=Em.ArrayPolyfills.filter,b=Em.ArrayPolyfills.forEach;EG.Store.reopen({allRelationships:new Em.Object,queuedRelationships:new Em.Object,initializeRelationships:Em.on("init",function(){this.setProperties({allRelationships:new Em.Object,queuedRelationships:new Em.Object})}),createRelationship:function(a,b,c,d,e,f,g){var h=new EG.Relationship(a,b,c,d,e,f,g),i=this.get("queuedRelationships"),j=this.getRecord(a,b),k=this.getRecord(d,e);j&&this.connectRelationshipTo(j,h),k&&this.connectRelationshipTo(k,h),j&&k||(i[h.get("id")]=h,this.notifyPropertyChange("queuedRelationships")),this.get("allRelationships")[h.get("id")]=h},deleteRelationship:function(a){var b=this.getRecord(a.get("type1"),a.get("id1")),c=this.getRecord(a.get("type2"),a.get("id2"));this.disconnectRelationshipFrom(b,a),this.disconnectRelationshipFrom(c,a);var d=this.get("queuedRelationships");delete d[a.get("id")],this.notifyPropertyChange("queuedRelationships"),delete this.get("allRelationships")[a.get("id")],delete this.get("queuedRelationships")[a.get("id")],a.erase()},changeRelationshipState:function(a,b){var c=this.getRecord(a.get("type1"),a.get("id1")),d=this.getRecord(a.get("type2"),a.get("id2"));this.disconnectRelationshipFrom(c,a),this.disconnectRelationshipFrom(d,a),a.set("state",b),this.connectRelationshipTo(c,a),this.connectRelationshipTo(d,a)},connectQueuedRelationships:function(c){var d=this.get("queuedRelationships"),e=a.call(Em.keys(d),function(a){return d[a].isConnectedTo(c)});e.length<=0||(b.call(e,function(a){var b=d[a];this.connectRelationshipTo(c,b),delete d[a]},this),this.notifyPropertyChange("queuedRelationships"))},relationshipsForRecord:function(a,b,c){var d=[],e=this.get("allRelationships");for(var f in e)e.hasOwnProperty(f)&&e[f].matchesOneSide(a,b,c)&&d.push(e[f]);return d},deleteRelationshipsForRecord:function(a,b){var c=this.get("allRelationships");for(var d in c)if(c.hasOwnProperty(d)){if(c[d].get("type1")===a&&c[d].get("id1")===b){delete c[d];continue}c[d].get("type2")===a&&c[d].get("id2")===b&&delete c[d]}},connectRelationshipTo:function(a,b){a&&a.get("relationships").addRelationship(b.thisName(a),b)},disconnectRelationshipFrom:function(a,b){a&&a.get("relationships").removeRelationship(b)}})}(),function(){EG.PromiseObject=Em.ObjectProxy.extend(Em.PromiseProxyMixin),EG.PromiseArray=Em.ArrayProxy.extend(Em.PromiseProxyMixin),EG.ModelPromiseObject=EG.PromiseObject.extend({__modelId:null,id:function(a,b){var c=this.get("content");return arguments.length>1&&(c&&c.set?c.set("id",b):this.set("__modelId",b)),c&&c.get?c.get("id"):this.get("__modelId")}.property("__modelId","content.id")})}(),function(){var a="client",b="server",c="deleted";EG.Relationship=Em.Object.extend({_state:a,state:Em.computed(function(d,e){if(arguments.length>1)switch(e){case a:case b:case c:this.set("_state",e)}return this.get("_state")}).property("_state"),id:null,typeKey1:null,id1:null,relationship1:null,typeKey2:null,id2:null,relationship2:null,init:function(a,b,c,d,e,f,g){this.setProperties({id:EG.generateUUID(),type1:a,id1:b,relationship1:c,type2:d,id2:e,relationship2:f,state:g})},isConnectedTo:function(a){return this.get("type1")===a.typeKey&&this.get("id1")===a.get("id")?!0:this.get("type2")===a.typeKey&&this.get("id2")===a.get("id")?!0:!1},matchesOneSide:function(a,b,c){return this.get("type1")===a&&this.get("id1")===b&&this.get("relationship1")===c?!0:this.get("type2")===a&&this.get("id2")===b&&this.get("relationship2")===c?!0:!1},otherType:function(a){return this.get(this.get("type1")===a.typeKey?"type2":"type1")},otherId:function(a){return this.get(this.get("id1")===a.get("id")?"id2":"id1")},otherName:function(a){return this.get(this.get("id1")===a.get("id")&&this.get("type1")===a.typeKey?"relationship2":"relationship1")},thisName:function(a){return this.get(this.get("id1")===a.get("id")&&this.get("type1")===a.typeKey?"relationship1":"relationship2")},erase:function(){this.setProperties({id:null,type1:null,id1:null,relationship1:null,type2:null,id2:null,relationship2:null,_state:null})}}),EG.Relationship.reopenClass({CLIENT_STATE:a,SERVER_STATE:b,DELETED_STATE:c})}(),function(){var a=Em.ArrayPolyfills.map,b=Em.ArrayPolyfills.forEach,c=EG.Relationship.CLIENT_STATE,d=EG.Relationship.SERVER_STATE,e=EG.Relationship.DELETED_STATE,f={};f[c]="client",f[d]="server",f[e]="deleted";var g=Em.Object.extend({length:0,addRelationship:function(a,b){if(this.hasOwnProperty(a))this.set(a+"."+b.get("id"),b),this.notifyPropertyChange(a);else{var c=new Em.Object;c.set(b.get("id"),b),this.set(a,c)}this.incrementProperty("length")},removeRelationship:function(a){b.call(Em.keys(this),function(b){if("length"!==b){var c=this.get(b);"object"==typeof c&&c.hasOwnProperty(a)&&(delete c[a],this.notifyPropertyChange(b),this.decrementProperty("length"))}},this)},getRelationships:function(b){var c=this.get(b)||{};return a.call(Em.keys(c),function(a){return c[a]})},getAllRelationships:function(){var a=[],c=new Em.Set(Em.keys(this)).without("length");return b.call(c,function(b){a=a.concat(this.getRelationships(b))},this),a},clearRelationships:function(a){this.set(a,new Em.Object),this.recalculateLength()},recalculateLength:function(){var a=0;b.call(Em.keys(this),function(b){"length"!==b&&(a+=Em.keys(this[b]).length)},this),this.set("length",a)}});EG.RelationshipStore=Em.Object.extend({server:null,client:null,deleted:null,initializeMaps:Em.on("init",function(){this.setProperties({server:new g,client:new g,deleted:new g})}),addRelationship:function(a,b){return null!==a?this.get(f[b.get("state")]).addRelationship(a,b):void 0},removeRelationship:function(a){"string"!==Em.typeOf(a)&&(a=Em.get(a,"id")),this.get("server").removeRelationship(a),this.get("client").removeRelationship(a),this.get("deleted").removeRelationship(a)},clearRelationships:function(a){this.get("server").clearRelationships(a),this.get("client").clearRelationships(a),this.get("deleted").clearRelationships(a)},getServerRelationships:function(a){return this.get("server").getRelationships(a).concat(this.get("deleted").getRelationships(a))},getCurrentRelationships:function(a){return this.get("server").getRelationships(a).concat(this.get("client").getRelationships(a))},getRelationshipsByState:function(a){return this.get(f[a]).getAllRelationships()},getRelationshipsByName:function(a){var b=this.get("server").getRelationships(a),c=this.get("client").getRelationships(a),d=this.get("deleted").getRelationships(a);return b.concat(c).concat(d)}})}(),function(){EG.AttributeType=Em.Object.extend({defaultValue:null,serialize:function(a){return a},deserialize:function(a){return a},isEqual:function(a,b){return a===b}})}(),function(){EG.ArrayType=EG.AttributeType.extend({serialize:function(){return Em.isNone(obj)?null:(obj=obj.toArray?obj.toArray():obj,Em.isArray(obj)?obj:null)},deserialize:function(a){return Em.isArray(a)?a:null},isEqual:function(a,b){return Em.isArray(a)&&Em.isArray(b)?0===Em.compare(a.toArray(),b.toArray()):!1}})}(),function(){EG.BooleanType=EG.AttributeType.extend({defaultValue:!1,serialize:function(a){return this.coerceToBoolean(a)},deserialize:function(a){return this.coerceToBoolean(a)},coerceToBoolean:function(a){return"boolean"===Em.typeOf(a)&&1==a?!0:"string"===Em.typeOf(a)&&"true"==a?!0:!1}})}(),function(){EG.DateType=EG.AttributeType.extend({serialize:function(a){switch(Em.typeOf(a)){case"date":return a.getTime();case"number":return a;case"string":return new Date(a).getTime();default:return null}},deserialize:function(a){switch(Em.typeOf(a)){case"number":case"string":return new Date(a);default:return null}},isEqual:function(a,b){var c=null===a,d=null===b;return c&&d?!0:c&&!d||!c&&d?!1:new Date(a).getTime()===new Date(b).getTime()}})}(),function(){EG.EnumType=EG.AttributeType.extend({defaultValue:Em.computed(function(){throw new Error("You must override the `defaultValue` in an enumeration type.")}).property(),values:[],valueSet:Em.computed(function(){return new Em.Set(this.get("values").map(function(a){return a.toLocaleLowerCase()}))}).property("values"),isValidValue:function(a){return this.get("valueSet").contains(a.toLowerCase())},serialize:function(a){if(a+="",this.isValidValue(a))return a;var b=this.get("defaultValue");if(this.isValidValue(b))return b;throw new Error("The default value you provided isn't a valid value.")},deserialize:Em.aliasMethod("serialize"),isEqual:function(a,b){return"string"!==Em.typeOf(a)||"string"!==Em.typeOf(b)?!1:(a+"").toLocaleLowerCase()===(b+"").toLocaleLowerCase()}})}(),function(){EG.NumberType=EG.AttributeType.extend({defaultValue:0,serialize:function(a){return this.coerceToNumber(a)},deserialize:function(a){return this.coerceToNumber(a)},coerceToNumber:function(a){if(this.isValidNumber(a))return Number(a).valueOf();if("string"===Em.typeOf(a)){var b=Number(a).valueOf();if(this.isValidNumber(b))return b}return 0},isValidNumber:function(a){return"number"===Em.typeOf(a)&&!isNaN(a)&&isFinite(a)}})}(),function(){EG.ObjectType=EG.AttributeType.extend({serialize:function(a){if(!this.isObject(a))return null;try{return JSON.stringify(a),a}catch(b){return null}},deserialize:function(a){return this.isObject(a)?a:null},isEqual:function(a,b){return this.isObject(a)&&this.isObject(b)?this.deepCompare(a,b):!1},isObject:function(a){return!Em.isNone(a)&&"object"===Em.typeOf(a)&&a.constructor===Object},deepCompare:function(a,b){if(this.isObject(a)&&this.isObject(b)){if(!new Em.Set(Em.keys(a)).isEqual(new Em.Set(Em.keys(b))))return!1;for(var c=Em.keys(a),d=0;d<c.length;d+=1)if(!this.deepCompare(a[c[d]],b[c[d]]))return!1;return!0}return Em.isArray(a)&&Em.isArray(b)?0===Em.compare(a,b):a===b}})}(),function(){EG.StringType=EG.AttributeType.extend({serialize:function(a){return null===a?null:""+a},deserialize:function(a){return null===a?null:""+a}})}(),function(){EG.Model=Em.Object.extend(Em.Evented,{typeKey:null,_id:null,id:Em.computed(function(a,b){var c=this.get("_id");if(arguments.length>1){var d=this.constructor.temporaryIdPrefix;if(null===c)return this.set("_id",b),b;if(EG.String.startsWith(c,d)&&!EG.String.startsWith(b,d))return this.set("_id",b),b;throw new Error("Cannot change the 'id' property of a model.")}return c}).property("_id"),store:null,loadData:function(a){a=a||{},this._loadAttributes(a),this.loadRelationships(a)},save:function(){var a=this,b=null;return b=this.get("isNew")?"isCreating":"isSaving",this.set(b,!0),this.get("store").saveRecord(this).finally(function(){a.set(b,!1)})},reload:function(){var a=this;return this.set("isReloading",!0),this.get("store").reloadRecord(this).finally(function(){a.set("isReloading",!1)})},destroy:function(){var a=this;return this.set("isDeleting",!0),this.get("store").deleteRecord(this).then(function(){a.set("isDeleted",!0),a.set("store",null)}).finally(function(){a.set("isDeleting",!1)})},isEqual:function(a){return a?this.typeKey===Em.get(a,"typeKey")&&this.get("id")===Em.get(a,"id"):void 0},rollback:function(){this.rollbackAttributes(),this.rollbackRelationships()}}),EG.Model.reopenClass({temporaryIdPrefix:"EG_TEMP_ID_",isTemporaryId:function(a){return EG.String.startsWith(a,this.temporaryIdPrefix)},create:function(){},_create:EG.Model.create,extend:function(){var a=Array.prototype.slice.call(arguments,0),b=a.pop()||{},c={},d={};b instanceof Em.Mixin||Em.keys(b).forEach(function(a){var e=b[a];b[a]&&(b[a].isRelationship?(d[a]=e,delete b[a]):b[a].isAttribute&&(c[a]=e,delete b[a]))}),a.push(b);var e=this._super.apply(this,a);return e._declareAttributes(c),e.declareRelationships(d),e},isEqual:function(a,b){return Em.isNone(a)||Em.isNone(b)?!1:this.detectInstance(a)?a.isEqual(b):this.detectInstance(b)?b.isEqual(a):this.detectInstance(Em.get(a,"content"))?Em.get(a,"content").isEqual(b):this.detectInstance(Em.get(b,"content"))?Em.get(b,"content").isEqual(a):!1}})}(),function(){EG.Model.reopen({isDeleting:!1,isDeleted:!1,isSaving:!1,isReloading:!1,isLoaded:Em.computed(function(){return null!==this.get("store")}).property("store"),isDirty:Em.computed.or("_areAttributesDirty","areRelationshipsDirty"),isCreating:!1,isNew:Em.computed(function(){return EG.String.startsWith(this.get("_id"),this.constructor.temporaryIdPrefix)}).property("_id"),isInTransit:Em.computed.or("isSaving","isDeleting","isCreating","isReloading")})}(),function(){var a=(new Em.Set(["id","type","content","length"]),function(a,b){var c={isAttribute:!0,type:b.type,isRequired:!b.hasOwnProperty("defaultValue"),defaultValue:b.defaultValue,readOnly:b.readOnly===!0,isEqual:b.isEqual},d=Em.computed(function(a,b){var c=this.constructor.metaForAttribute(a),d=this.get("_serverAttributes."+a),e=this.get("_clientAttributes."+a),f=void 0===e?d:e;if(void 0!==b){var g=c.isEqual||this.get("store").attributeTypeFor(c.type).isEqual;return g(d,b)?delete this.get("_clientAttributes")[a]:this.set("_clientAttributes."+a,b),this.notifyPropertyChange("_clientAttributes"),b}return f}).property("_clientAttributes."+a,"_serverAttributes."+a).meta(c);return b.readOnly?d.readOnly():d});EG.Model.reopenClass({_declareAttributes:function(b){var c={};
Em.keys(b).forEach(function(d){c[d]=a(d,b[d].options)}),this.reopen(c)},attributes:Em.computed(function(){var a=new Em.Set;return this.eachComputedProperty(function(b,c){c.isAttribute&&a.addObject(b)}),a}).property(),metaForAttribute:Em.aliasMethod("metaForProperty"),isAttribute:function(a){return Em.get(this,"attributes").contains(a)},eachAttribute:function(a,b){this.eachComputedProperty(function(c,d){d.isAttribute&&a.call(b,c,d)})}}),EG.Model.reopen({_serverAttributes:null,_clientAttributes:null,_initializeAttributes:function(){this.set("_serverAttributes",Em.Object.create()),this.set("_clientAttributes",Em.Object.create())}.on("init"),_areAttributesDirty:Em.computed(function(){return Em.keys(this.get("_clientAttributes")||{}).length>0}).property("_clientAttributes"),changedAttributes:function(){var a={},b=this.get("store");return this.constructor.eachAttribute(function(c,d){var e=this.get("_serverAttributes."+c),f=this.get("_clientAttributes."+c),g=b.attributeTypeFor(d.type),h=d.isEqual||g.isEqual;void 0===f||h(e,f)||(a[c]=[e,f])},this),a},rollbackAttributes:function(){this.set("_clientAttributes",Em.Object.create())},_loadAttributes:function(a){this.constructor.eachAttribute(function(b,c){var d=a.hasOwnProperty(b)?a[b]:c.defaultValue;this.set("_serverAttributes."+b,d),this._synchronizeAttribute(b)},this)},_synchronizeAttribute:function(a){var b=this.get("_serverAttributes."+a),c=this.get("_clientAttributes."+a),d=this.constructor.metaForAttribute(a),e=d.isEqual||this.get("store").attributeTypeFor(d.type).isEqual;e(b,c)&&(delete this.get("_clientAttributes")[a],this.notifyPropertyChange("_clientAttributes"))}})}(),function(){var a=Em.ArrayPolyfills.map,b=(EG.ArrayPolyfills.some,Em.ArrayPolyfills.reduce,Em.ArrayPolyfills.filter),c=Em.ArrayPolyfills.forEach,d=EG.Model.HAS_ONE_KEY="hasOne",e=EG.Model.HAS_MANY_KEY="hasMany",f=EG.Relationship.CLIENT_STATE,g=EG.Relationship.SERVER_STATE,h=EG.Relationship.DELETED_STATE,i=function(a,b,c){var d={isRelationship:!1,kind:b,isRequired:c.hasOwnProperty("defaultValue")?!1:c.isRequired!==!1,defaultValue:c.defaultValue||(b===e?[]:null),relatedType:c.relatedType,inverse:c.inverse,isReadOnly:c.readOnly===!0,isPolymorphic:c.polymorphic===!0};return d.kind===e?Em.computed(function(a){return this.getHasManyValue(a.substring(1),!1)}).property("relationships.client."+a,"relationships.deleted."+a).meta(d).readOnly():Em.computed(function(a){return this.getHasOneValue(a.substring(1),!1)}).property("relationships.client."+a,"relationships.deleted."+a).meta(d).readOnly()};EG.Model.reopenClass({metaForRelationship:Em.aliasMethod("metaForProperty"),relationshipKind:function(a){return this.metaForRelationship(a).kind},eachRelationship:function(a,b){this.eachComputedProperty(function(c,d){d.isRelationship&&a.call(b,c,d)})},declareRelationships:function(a){var b={};c.call(Em.keys(a),function(c){b["_"+c]=i(c,a[c].kind,a[c].options);var e,f=Em.copy(b["_"+c].meta(),!0),g=f.relatedType;e=f.kind===d?function(a){var b=this.getHasOneValue(a,!1);return b?this.get("store").find(b.type,b.id):null}:f.isPolymorphic?function(a){var b=this.get("store"),c=this.getHasManyValue(a,!1),d=EG.groupRecords(c),e=Em.ArrayPolyfills.map.call(d,function(a){var c=Em.ArrayPolyfills.map.call(a,function(a){return a.id});return b.find(a[0].type,c)});return Em.RSVP.Promise.all(e).then(function(a){return Em.ArrayPolyfills.reduce.call(a,function(a,b){return a.concat(b)},[])})}:function(a){var b=this.getHasManyValue(a,!1),c=Em.ArrayPolyfills.map.call(b,function(a){return a.id});return this.get("store").find(g,c)},f.isRelationship=!0,b[c]=Em.computed(e).property("_"+c).readOnly().meta(f)}),this.reopen(b)}}),EG.Model.reopen({areRelationshipsDirty:Em.computed(function(){return this.get("relationships.client.length")>0||this.get("relationships.deleted.length")>0}).property("relationships.client.length","relationships.deleted.length"),changedRelationships:function(){var b={};return this.constructor.eachRelationship(function(c,d){var f,g;if(d.kind===e){f=this.getHasManyValue(c,!0);{a.call(f,function(a){return a.type+"."+a.id})}g=this.getHasManyValue(c,!1);{a.call(g,function(a){return a.type+"."+a.id})}EG.arrayContentsEqual(f,g)||(b[c]=[f,g])}else f=this.getHasOneValue(c,!0),g=this.getHasOneValue(c,!1),f!==g&&(b[c]=[f,g])},this),b},rollbackRelationships:function(){Em.changeProperties(function(){var a=this.get("store"),b=this.get("relationships").getRelationshipsByState(f);c.call(b,function(b){a.deleteRelationship(b)});var d=this.get("relationships").getRelationshipsByState(h);c.call(d,function(b){a.changeRelationshipState(b,g)})},this)},addToRelationship:function(a,b,c){Em.changeProperties(function(){var e,h=this.get("store"),i=this.constructor.metaForRelationship(a);if(!i.isReadOnly){"string"!==Em.typeOf(b)?(c=b.typeKey,b=b.get("id")):"string"!==Em.typeOf(c)&&(c=i.relatedType);var j=this.getHasManyRelationships(a,!1);for(e=0;e<j.length;++e)if(j[e].otherType(this)===c&&j[e].otherId(this)===b)return;var k=this.getHasManyRelationships(a,!0),l=null;for(e=0;e<k.length;++e)if(k[e].otherType(this)===c&&k[e].otherId(this)===b){l=k[e];break}if(null===i.inverse)return void(l?h.changeRelationshipState(l,g):h.createRelationship(this.typeKey,this.get("id"),a,c,b,null,f));var m=h.modelForType(c).metaForRelationship(i.inverse).kind;if(m.kind===d){var n=h.getRecord(c,b);if(n){var o=n.getHasOneRelationship(i.inverse,!1);o&&(o.get("state")===f?h.deleteRelationship(o):h.changeRelationshipState(o))}}return l?void h.changeRelationshipState(l,g):void h.createRelationship(this.typeKey,this.get("id"),a,c,b,i.inverse,f)}},this)},removeFromRelationship:function(a,b,c){Em.changeProperties(function(){var d=this.constructor.metaForRelationship(a);if(!d.isReadOnly){"string"!==Em.typeOf(b)?(c=b.typeKey,b=b.get("id")):"string"!==Em.typeOf(c)&&(c=d.relatedType);for(var e=this.getHasManyRelationships(a,!1),g=0;g<e.length;++g)if(e[g].otherType(this)===c&&e[g].otherId(this)===b){e[g].get("state")===f?this.get("store").deleteRelationship(e[g]):this.get("store").changeRelationshipState(e[g],h);break}}},this)},setHasOneRelationship:function(a,c,e){Em.changeProperties(function(){var i=this.get("store"),j=this.constructor.metaForRelationship(a);if(!j.isReadOnly){"string"!==Em.typeOf(c)?(e=c.typeKey,c=c.get("id")):"string"!==Em.typeOf(e)&&(e=j.relatedType);var k=b.call(this.getRelationshipsByName(a),function(a){return a.otherType(this)===e&&a.otherId(this)===c},this)[0],l=this.getHasOneRelationship(a,!1);if(l){if(l.otherType(this)===e&&l.otherId(this)===c)return;l.get("state")===f?i.deleteRelationship(l):i.changeRelationshipState(l,h)}if(null===j.inverse)return void(k?i.changeRelationshipState(k,g):i.createRelationship(this.typeKey,this.get("id"),a,e,c,null,f));var m=i.modelForType(e).metaForRelationship(j.inverse).kind;if(m.kind===d){var n=i.getRecord(e,c);if(n){var o=n.getHasOneRelationship(j.inverse,!1);o&&(o.get("state")===f?i.deleteRelationship(o):i.changeRelationshipState(o))}}return k?void i.changeRelationshipState(k,g):void i.createRelationship(this.typeKey,this.get("id"),a,e,c,j.inverse,f)}},this)},clearHasOneRelationship:function(a){Em.changeProperties(function(){var b=this.constructor.metaForRelationship(a);if(!b.isReadOnly){var c=this.getHasOneRelationship(a,!1);c&&(c.get("state")===f?this.get("store").deleteRelationship(c):this.get("store").changeRelationshipState(c,h))}},this)}}),EG.Model.reopen({relationships:null,initializeRelationships:Em.on("init",function(){this.set("relationships",new EG.RelationshipStore)}),getHasOneRelationship:function(a,b){var c;return c=b?this.get("relationships").getServerRelationships(a):this.get("relationships").getCurrentRelationships(a),c.length<=0?null:c[0]},getHasOneValue:function(a,b){var c=this.getHasOneRelationship(a,b);return null===c?null:{type:c.otherType(this),id:c.otherId(this)}},getHasManyRelationships:function(a,b){return b?this.get("relationships").getServerRelationships(a):this.get("relationships").getCurrentRelationships(a)},getHasManyValue:function(b,c){return a.call(this.getHasManyRelationships(b,c),function(a){return{type:a.otherType(this),id:a.otherId(this)}},this)},getRelationshipsByName:function(a){return this.get("relationships").getRelationshipsByName(a)}})}(),function(){var a=Em.ArrayPolyfills.map,b=Em.ArrayPolyfills.filter,c=Em.ArrayPolyfills.forEach;EG.Model.reopen({loadRelationships:function(a){this.constructor.eachRelationship(function(b,c){var d=null;if(c.inverse&&(d=this.get("store").modelForType(c.relatedType).metaForRelationship(c.inverse).kind),c.kind===HAS_MANY_KEY)switch(d){case HAS_ONE_KEY:this.connectHasManyToHasOne(b,c,a[b]);break;case HAS_MANY_KEY:this.connectHasManyToHasMany(b,c,a[b]);break;default:this.connectHasManyToNull(b,c,a[b])}else if(a[b])switch(d){case HAS_ONE_KEY:this.connectHasOneToHasOne(b,c,a[b]);break;case HAS_MANY_KEY:this.connectHasOneToHasMany(b,c,a[b]);break;default:this.connectHasOneToNull(b,c,a[b])}else switch(d){case HAS_ONE_KEY:this.disconnectHasOneFromHasOne(b,c);break;case HAS_MANY_KEY:this.disconnectHasOneFromHasMany(b,c);break;default:this.disconnectHasOneFromNull(b,c)}},this)},disconnectHasOneFromNull:Em.aliasMethod("disconnectHasOneFromHasMany"),disconnectHasOneFromHasOne:Em.aliasMethod("disconnectHasOneFromHasMany"),disconnectHasOneFromHasMany:function(a){var b=this.get("store"),d=this.sortHasOneRelationships(this.typeKey,this.get("id"),a);return d[DELETED_STATE].length>0&&c.call(d[DELETED_STATE],function(a){b.deleteRelationship(a)},this),d[SERVER_STATE]||d[CLIENT_STATE]?d[SERVER_STATE]&&!d[CLIENT_STATE]?void b.deleteRelationship(d[SERVER_STATE]):void(!d[SERVER_STATE]&&d[CLIENT_STATE]&&(b.get("sideWithClientOnConflict")||b.deleteRelationship(d[CLIENT_STATE]))):void 0},connectHasOneToNull:Em.aliasMethod("connectHasOneToHasMany"),connectHasOneToHasOne:function(){},connectHasOneToHasMany:function(a,b,d){var e=this.typeKey,f=this.get("id"),g=this.get("store"),h=this.sortHasOneRelationships(e,f,a);return h[SERVER_STATE]&&h[SERVER_STATE].otherType(this)===d.type&&h[SERVER_STATE].otherId(this)===d.id||h[CLIENT_STATE]&&h[CLIENT_STATE].otherType(this)===d.type&&h[CLIENT_STATE].otherId(this)===d.id?void 0:!h[SERVER_STATE]&&!h[CLIENT_STATE]&&h[DELETED_STATE].length<=0?void g.createRelationship(e,f,a,d.type,d.id,b.inverse,SERVER_STATE):h[SERVER_STATE]&&!h[CLIENT_STATE]&&h[DELETED_STATE].length<=0?(g.deleteRelationship(h[SERVER_STATE]),void g.createRelationship(e,f,a,d.type,d.id,b.inverse,SERVER_STATE)):!h[SERVER_STATE]&&h[CLIENT_STATE]&&h[DELETED_STATE].length<=0?void(g.get("sideWithClientOnConflict")?g.createRelationship(e,f,a,d.type,d.id,b.inverse,DELETED_STATE):(g.deleteRelationship(h[CLIENT_STATE]),g.createRelationship(e,f,a,d.type,d.id,b.inverse,SERVER_STATE))):!h[SERVER_STATE]&&!h[CLIENT_STATE]&&h[DELETED_STATE].length>=0?(c.call(h[DELETED_STATE],function(a){g.deleteRelationship(a)}),void g.createRelationship(e,f,a,d.type,d.id,b.inverse,SERVER_STATE)):!h[SERVER_STATE]&&h[CLIENT_STATE]&&h[DELETED_STATE].length>=0?(c.call(h[DELETED_STATE],function(a){g.deleteRelationship(a)}),void(g.get("sideWithClientOnConflict")?g.createRelationship(e,f,a,d.type,d.id,b.inverse,DELETED_STATE):(g.deleteRelationship(h[CLIENT_STATE]),g.createRelationship(e,f,a,d.type,d.id,b.inverse,SERVER_STATE)))):void 0},connectHasManyToNull:Em.aliasMethod("connectHasManyToHasMany"),connectHasManyToHasOne:function(){},connectHasManyToHasMany:function(b,d,e){var f=this.typeKey,g=this.get("id"),h=this.get("store"),i=h.relationshipsForRecord(f,g,b),j=new Em.Set(a.call(e,function(a){return a.type+":"+a.id})),k=new Em.Set;c.call(i,function(a){var b=a.otherType(this)+":"+a.otherId(this);j.contains(b)&&(a.get("state")===CLIENT_STATE?h.changeRelationshipState(a,SERVER_STATE):a.get("state")!==DELETED_STATE||h.get("sideWithClientOnConflict")||h.changeRelationshipState(a,SERVER_STATE)),k.addObject(b)},this),c.call(e,function(a){var c=a.type+":"+a.id;k.contains(c)||h.createRelationship(f,g,b,a.type,a.id,d.inverse,SERVER_STATE)},this)},sortHasOneRelationships:function(a,c,d){var e={},f=this.get("store").relationshipsForRecord(a,c,d);return e[SERVER_STATE]=b.call(f,function(a){return a.get("state")===SERVER_STATE})[0]||null,e[DELETED_STATE]=b.call(f,function(a){return a.get("state")===DELETED_STATE}),e[CLIENT_STATE]=b.call(f,function(a){return a.get("state")===CLIENT_STATE})[0]||null,e}})}(),function(){EG.attr=function(a){return{isAttribute:!0,options:a}},EG.hasMany=function(a){return{isRelationship:!0,kind:EG.Model.HAS_MANY_KEY,options:a}},EG.hasOne=function(a){return{isRelationship:!0,kind:EG.Model.HAS_ONE_KEY,options:a}}}();